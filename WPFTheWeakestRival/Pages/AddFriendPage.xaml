<Page x:Class="WPFTheWeakestRival.Pages.AddFriendPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:loc="clr-namespace:WPFTheWeakestRival.Globalization"
      SnapsToDevicePixels="True"
      TextOptions.TextRenderingMode="Aliased"
      Title="{loc:Loc addFriendTitle}"
      Background="Transparent">

    <Page.Resources>
        <BooleanToVisibilityConverter x:Key="BoolToVis"/>

        <Style TargetType="Button" x:Key="BaseButton">
            <Setter Property="Margin" Value="0,0,6,0"/>
            <Setter Property="Height" Value="28"/>
            <Setter Property="MinWidth" Value="86"/>
        </Style>

        <Style TargetType="Button"
               x:Key="HoverScaleButton"
               BasedOn="{StaticResource BaseButton}">
            <Setter Property="RenderTransformOrigin" Value="0.5,0.5"/>
            <Setter Property="RenderTransform">
                <Setter.Value>
                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="RenderTransform">
                        <Setter.Value>
                            <ScaleTransform ScaleX="1.06" ScaleY="1.06"/>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>
    </Page.Resources>

    <!-- Capa exterior: ocupa todo el frame, para poder centrar el contenido dentro de la tablet -->
    <Grid Background="Transparent">
        <!-- Contenedor centrado: ajusta Width/Height si quieres que se vea más grande/chico -->
        <Grid Width="620"
              Height="360"
              HorizontalAlignment="Center"
              VerticalAlignment="Center">

            <!-- Layout interno con márgenes respecto al área visible de la pantalla -->
            <Grid Margin="24">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="12"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Título -->
                <TextBlock x:Name="lblTitle"
                           Text="{loc:Loc addFriendTitle}"
                           FontSize="22"
                           Foreground="White"
                           FontWeight="Bold"
                           HorizontalAlignment="Left"/>

                <!-- Buscador -->
                <StackPanel Grid.Row="2"
                            Orientation="Horizontal"
                            VerticalAlignment="Center">
                    <TextBox x:Name="txtSearchQuery"
                             MinWidth="320"
                             Width="Auto"
                             Height="28"
                             Margin="0,0,8,0"
                             HorizontalAlignment="Stretch"
                             VerticalContentAlignment="Center"
                             TextChanged="TxtSearchQueryTextChanged"
                             ToolTip="{loc:Loc addFriendSearchTooltip}"/>

                    <Button x:Name="btnSearch"
                            Style="{StaticResource HoverScaleButton}"
                            Content="{loc:Loc commonSearch}"
                            Click="BtnSearchClick"/>

                    <TextBlock x:Name="lblStatus"
                               Margin="12,0,0,0"
                               VerticalAlignment="Center"/>
                </StackPanel>

                <!-- Resultados -->
                <Border Grid.Row="4"
                        BorderBrush="#40000000"
                        BorderThickness="1"
                        CornerRadius="6"
                        Padding="6"
                        Background="#20000000">
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <ItemsControl x:Name="lstResults">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border Margin="0,4"
                                            Padding="8"
                                            CornerRadius="6"
                                            Background="#22000000">
                                        <DockPanel LastChildFill="False">
                                            <Image Width="36"
                                                   Height="36"
                                                   Stretch="UniformToFill"
                                                   Margin="0,0,8,0"
                                                   Source="{Binding Avatar}"
                                                   ClipToBounds="True"/>

                                            <StackPanel Orientation="Vertical"
                                                        VerticalAlignment="Center"
                                                        DockPanel.Dock="Left"
                                                        Width="260">
                                                <TextBlock Text="{Binding DisplayName}"
                                                           Foreground="White"
                                                           FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding Email}"
                                                           Opacity="0.7"
                                                           Foreground="White"
                                                           FontSize="12"/>
                                                <TextBlock Text="{Binding StateText}"
                                                           FontSize="12"
                                                           Foreground="White"
                                                           Margin="0,4,0,0"/>
                                            </StackPanel>

                                            <StackPanel Orientation="Horizontal"
                                                        VerticalAlignment="Center">
                                                <!-- Aceptar solicitud -->
                                                <Button Style="{StaticResource HoverScaleButton}"
                                                        Content="{loc:Loc addFriendAccept}"
                                                        Visibility="{Binding ShowAccept, Converter={StaticResource BoolToVis}}"
                                                        Click="BtnAcceptClick"/>

                                                <!-- Agregar / Pendiente / Amigos -->
                                                <Button Style="{StaticResource HoverScaleButton}"
                                                        Content="{Binding AddButtonText}"
                                                        IsEnabled="{Binding CanAdd}"
                                                        Click="BtnAddClick"/>
                                            </StackPanel>
                                        </DockPanel>
                                    </Border>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>
                </Border>

                <!-- Cerrar -->
                <StackPanel Grid.Row="5"
                            Orientation="Horizontal"
                            HorizontalAlignment="Right"
                            Margin="0,8,0,0">
                    <Button x:Name="btnClose"
                            Style="{StaticResource HoverScaleButton}"
                            Content="{loc:Loc commonClose}"
                            Click="BtnCloseClick"/>
                </StackPanel>
            </Grid>
        </Grid>
    </Grid>
</Page>
