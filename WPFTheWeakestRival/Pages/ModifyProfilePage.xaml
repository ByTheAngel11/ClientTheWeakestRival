<Page x:Class="WPFTheWeakestRival.ModifyProfilePage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:language="clr-namespace:WPFTheWeakestRival.Properties.Langs"
      xmlns:loc="clr-namespace:WPFTheWeakestRival.Globalization"
      Title="{loc:Loc modifyProfileTitle}"
      Width="660" Height="360"
      MinWidth="640" MinHeight="340">

    <!-- Grid raíz con fondo -->
    <Grid Grid.IsSharedSizeScope="True">
        <Grid.Background>
            <ImageBrush ImageSource="pack://application:,,,/Assets/Backgrounds/ModifyProfileBackground.png"
                        Stretch="UniformToFill"
                        AlignmentX="Center"
                        AlignmentY="Center" />
        </Grid.Background>

        <!-- Distribución general: encabezado / contenido / footer -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <!-- header sobre la franja azul -->
            <RowDefinition Height="*"/>
            <!-- zona crema central -->
            <RowDefinition Height="Auto"/>
            <!-- botones sobre la parte superior de la franja inferior -->
        </Grid.RowDefinitions>

        <!-- Título (lo bajo un poco para centrarlo en la franja superior) -->
        <TextBlock Grid.Row="0"
                   Text="{loc:Loc modifyProfileTitle}"
                   FontSize="22"
                   FontWeight="Bold"
                   Margin="32,20,32,0"
                   VerticalAlignment="Center"
                   Foreground="White"/>

        <!-- Contenido en la zona central crema -->
        <Grid Grid.Row="1"
              Margin="32,20,32,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <!-- preview -->
                <ColumnDefinition Width="24"/>
                <!-- separación -->
                <ColumnDefinition Width="*"/>
                <!-- formulario -->
            </Grid.ColumnDefinitions>

            <!-- Vista previa compacta -->
            <Border Grid.Column="0"
                    BorderBrush="#DDD"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="8"
                    Margin="0,27,0,-7"
                    Background="#10FFFFFF">
                <Image x:Name="imgPreview"
                       Width="180"
                       Height="180"
                       Stretch="UniformToFill"
                       SnapsToDevicePixels="True"
                       RenderOptions.BitmapScalingMode="HighQuality"/>
            </Border>

            <!-- Formulario: etiquetas y campos alineados -->
            <Grid Grid.Column="2" Margin="0,38,0,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="8"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" SharedSizeGroup="Labels"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Email -->
                <TextBlock Grid.Row="0"
                           Grid.Column="0"
                           Text="{loc:Loc lblEmail}"
                           VerticalAlignment="Center"/>
                <TextBox x:Name="txtEmail"
                         Grid.Row="0"
                         Grid.Column="2"
                         MaxLength="320"
                         MinWidth="240"
                         Height="26"/>

                <!-- Display name -->
                <TextBlock Grid.Row="2"
                           Grid.Column="0"
                           Text="{loc:Loc registerDisplayName}"
                           VerticalAlignment="Center"/>
                <TextBox x:Name="txtDisplayName"
                         Grid.Row="2"
                         Grid.Column="2"
                         MaxLength="80"
                         MinWidth="240"
                         Height="26"/>

                <!-- URL + botones -->
                <TextBlock Grid.Row="4"
                           Grid.Column="0"
                           Text="{loc:Loc profileAvatar}"
                           VerticalAlignment="Center"/>
                <Grid Grid.Row="4"
                      Grid.Column="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="0*"/>
                        <ColumnDefinition Width="Auto" MinWidth="164.76"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- TextBox oculto para mantener la lógica existente -->
                    <TextBox x:Name="txtAvatarUrl"
                             Grid.Column="0"
                             Visibility="Collapsed"/>

                    <Button x:Name="btnBrowse"
                            Grid.Column="1"
                            Content="{loc:Loc btnProfileBrowse}"
                            Margin="3,0,83,0"
                            Click="BtnBrowseClick"/>

                    <Button Grid.Column="1"
                            Content="{loc:Loc btnProfileRemoveImage}"
                            Width="100"
                            Click="BtnClearImageClick" Grid.ColumnSpan="2" Margin="155,0,10,0"/>
                </Grid>
            </Grid>
        </Grid>

        <!-- Acciones compactas alineadas justo encima de la franja inferior -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Right"
                    Margin="0,0,32,50">
            <Button Content="{loc:Loc cancel}"
                    Width="96"
                    Height="28"
                    Margin="0,0,8,0"
                    Background="DarkRed"
                    Foreground="White"
                    Click="BtnCancelClick"/>
            <Button Content="{loc:Loc save}"
                    Background="DarkBlue"
                    Foreground="White"
                    Width="110"
                    Height="28"
                    Click="BtnSaveClick"/>
        </StackPanel>

        <!-- Cerrar sesión alineado a la izquierda -->
        <Button Name="btnLogout"
                Grid.Row="2"
                Content="{loc:Loc btnLogout}"
                HorizontalAlignment="Left"
                VerticalAlignment="Center"
                Margin="32,0,0,35"
                Click="LogoutClick"
                Height="24"
                Width="84"/>
    </Grid>
</Page>
