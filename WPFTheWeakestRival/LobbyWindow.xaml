<Window x:Class="WPFTheWeakestRival.LobbyWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        Title="Lobby" Height="480" Width="900"
        WindowStartupLocation="CenterScreen"
        KeyDown="Window_KeyDown">

    <!-- =================== Recursos =================== -->
    <Window.Resources>
        <!-- Colores -->
        <SolidColorBrush x:Key="OverlayBackdropBrush" Color="#99000000"/>
        <SolidColorBrush x:Key="OverlayCardBackgroundBrush" Color="#FAFFFFFF"/>

        <!-- Dimensiones (usar sys:Double en WPF) -->
        <sys:Double x:Key="TopBarButtonWidth">130</sys:Double>
        <sys:Double x:Key="TopBarButtonHeight">32</sys:Double>
        <Thickness x:Key="TopBarButtonMargin">0,0,12,0</Thickness>
        <CornerRadius x:Key="OverlayCardCornerRadius">14</CornerRadius>
        <sys:Double x:Key="OverlayShadowBlur">16</sys:Double>
        <sys:Double x:Key="OverlayShadowOpacity">0.45</sys:Double>

        <!-- Estilos -->
        <Style x:Key="TopBarButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="{StaticResource TopBarButtonWidth}"/>
            <Setter Property="Height" Value="{StaticResource TopBarButtonHeight}"/>
            <Setter Property="Margin" Value="{StaticResource TopBarButtonMargin}"/>
        </Style>

        <Style x:Key="OverlayCloseButtonStyle" TargetType="Button">
            <Setter Property="Width" Value="32"/>
            <Setter Property="Height" Value="32"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Content" Value="✕"/>
        </Style>
    </Window.Resources>

    <Grid Margin="8">

        <!-- ===== Zona principal que se difumina ===== -->
        <Grid x:Name="grdMainArea">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Barra superior -->
            <Grid Grid.Row="0">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Left">
                    <Button Style="{StaticResource TopBarButtonStyle}" Content="Configuración"/>
                    <Button Style="{StaticResource TopBarButtonStyle}" Content="Personalización"/>
                    <Button Style="{StaticResource TopBarButtonStyle}" Width="110" Content="Marcadores"/>
                    <Button x:Name="btnModifyProfile"
                            Style="{StaticResource TopBarButtonStyle}"
                            Content="Modificar Perfil"
                            Click="btnModifyProfile_Click"/>
                </StackPanel>

                <Button Content="Amigos"
                        Style="{StaticResource TopBarButtonStyle}" Width="100"
                        HorizontalAlignment="Right"/>
            </Grid>

            <!-- Contenido principal -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="260"/>
                </Grid.ColumnDefinitions>

                <Grid Grid.Column="0" Margin="8">
                    <Image Width="180" Height="220"
                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    <Button Content="JUGAR" Width="160" Height="44"
                            HorizontalAlignment="Left" VerticalAlignment="Bottom" Margin="8"/>
                </Grid>

                <Grid Grid.Column="1" Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="32"/>
                    </Grid.RowDefinitions>

                    <ListBox Grid.Row="0"
                             x:Name="lstChatMessages"
                             ScrollViewer.VerticalScrollBarVisibility="Auto"
                             VirtualizingPanel.IsVirtualizing="True"
                             VirtualizingPanel.ScrollUnit="Pixel"/>

                    <TextBox Grid.Row="1" x:Name="txtChatInput" Text="Chat"/>
                </Grid>
            </Grid>
        </Grid>

        <!-- =================== Overlay =================== -->
        <Grid x:Name="pnlOverlayHost" Visibility="Collapsed" Opacity="0" Panel.ZIndex="99">
            <Rectangle Fill="{StaticResource OverlayBackdropBrush}"/>
            <Border Width="700" Height="420"
                    Background="{StaticResource OverlayCardBackgroundBrush}"
                    CornerRadius="{StaticResource OverlayCardCornerRadius}"
                    Padding="16"
                    HorizontalAlignment="Center" VerticalAlignment="Center">
                <Border.Effect>
                    <DropShadowEffect BlurRadius="{StaticResource OverlayShadowBlur}"
                                      ShadowDepth="0"
                                      Opacity="{StaticResource OverlayShadowOpacity}"/>
                </Border.Effect>
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <DockPanel LastChildFill="False" Margin="0,0,0,12">
                        <TextBlock Text="{Binding ElementName=frmOverlayFrame, Path=Content.Title, FallbackValue=Página}"
                                   FontSize="22" FontWeight="Bold"
                                   DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <Button Style="{StaticResource OverlayCloseButtonStyle}"
                                DockPanel.Dock="Right"
                                Click="CloseOverlay_Click"/>
                    </DockPanel>

                    <Frame x:Name="frmOverlayFrame" Grid.Row="1"
                           NavigationUIVisibility="Hidden" Background="Transparent"/>
                </Grid>
            </Border>
        </Grid>

    </Grid>
</Window>
